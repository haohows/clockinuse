(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"5f37":function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));n("99af"),n("a15b"),n("d81d"),n("4de4");var o=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,r=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,c=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,a=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,i=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,s=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/,u=/^\+?[1-9][0-9]*$|^(0|[1-9][0-9]*)$/,l=/^\+?[1-9][0-9]*$/,d={date:function(t){return/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(t)||"請輸入正確的日期格式"},time:function(t){return/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(t)||"請輸入正確的時間格式"},hexaColor:function(t){return r.test(t)},hexOrHexaColor:function(t){return c.test(t)},rgbColor:function(t){return a.test(t)},rgbaColor:function(t){return i.test(t)},rgbOrRgbaColor:function(t){return a.test(t)||i.test(t)},hexOrRgbColor:function(t){return o.test(t)||a.test(t)},hexaOrRgbaColor:function(t){return r.test(t)||i.test(t)},anyColor:function(t){return c.test(t)||a.test(t)||i.test(t)},email:function(t){return s.test(t)||"請輸入正確的信箱格式"},required:function(t){return!!t||"該欄位為必填項目"},maxSize:function(t,e,n){return function(n){return!n||(n.length<=e||"".concat(t||"該欄位","不得超過").concat(e,"字"))}},minSize:function(t,e,n){return function(n){return!n||(n.length>=e||"".concat(t||"該欄位","必須超過").concat(e,"字"))}},rangeSize:function(t,e,n,o){return function(o){return!o||(o.length>=e&&o.length<=n||"".concat(t||"該欄位","必須超過").concat(e,"字且不得超過").concat(n,"字"))}},rangeNumber:function(t,e,n,o){return function(o){return!o||(o>=e&&o<=n||"".concat(t||"該欄位","必須介於").concat(e,"~").concat(n,"之間"))}},mustSize:function(t,e,n){return function(n){return!n||(n.length==e||"".concat(t||"該欄位","長度必須為").concat(e,"字"))}},naturalNumberIZ:function(t){return!t||(u.test(t)||"該欄位需為正整數或零")},naturalNumber:function(t){return!t||(l.test(t)||"該欄位需為正整數")},notZero:function(t){return!t||(0!=t||"該欄位不得為零")},maxNumber:function(t,e){return function(e){return!e||(e<=t||"該欄位不得超過".concat(t))}},minNumber:function(t,e){return function(e){return!e||(e>=t||"該欄位不得低於".concat(t))}},responseError:function(t){var e=_.join(_.map(_.filter(this.errorMessage,(function(e,n,o){return _.upperCase(e.Key)==_.upperCase(t)&&e})),(function(t,e,n){return t.Message})),"、");return e},responseErrorHas:function(t){var e=_.some(this.errorMessage,(function(e,n,o){return _.upperCase(e.Key)==_.upperCase(t)}));return e},blurError:function(t){!this.responseErrorHas(t)||this.removeError(t)},removeError:function(t){this.errorMessage=_.remove(this.errorMessage,(function(e,n,o){return _.upperCase(e.Key)!=_.upperCase(t)}))}}},"8c6a":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-layout",[n("q-page-container",[n("q-page",{staticClass:"row justify-center items-center"},[Object.keys(t.clockData).length?n("q-card",{staticClass:"shadow-8",staticStyle:{width:"350px"},attrs:{square:""}},[n("q-card-section",{staticClass:"bg-blue-grey-9"},[n("h4",{staticClass:"text-white text-center q-my-sm"},[t._v("遠端打卡系統")]),n("h5",{staticClass:"text-white text-center q-my-sm"},[t._v("\n            "+t._s(t.clockData.companyName)+"\n          ")]),n("p",{staticClass:"text-white text-center q-my-sm"},[t._v(t._s(t.nowTime))])]),n("q-form",{on:{submit:t.checkPosition,keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}}},[n("q-card-section",{staticClass:"q-py-none"},[n("div",{staticClass:"q-px-md q-pt-lg q-pb-lg"},[t.clockTime.locationSwitch?n("div",{staticClass:"q-pa-sm q-mb-sm text-blue-8",staticStyle:{"font-size":"14px"}},[t._v("\n                管理者已啟用定位功能，點擊打卡鈕後，請同意系統讀取您的位置資訊。\n              ")]):t._e(),n("q-select",{attrs:{label:"打卡類別",options:t.options.clockInType,type:"text",filled:"","option-label":"text","option-value":"value","emit-value":"","map-options":"",rules:[t.rules.required],"hide-bottom-space":""},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"receipt_long"}})]},proxy:!0}]),model:{value:t.addClockRecord.clockInType,callback:function(e){t.$set(t.addClockRecord,"clockInType",e)},expression:"addClockRecord.clockInType"}}),n("q-input",{staticClass:"q-my-md",attrs:{filled:"",type:"text",label:"輸入您的姓名",rules:[t.rules.required],"hide-bottom-space":""},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"person"}})]},proxy:!0}]),model:{value:t.addClockRecord.staffName,callback:function(e){t.$set(t.addClockRecord,"staffName","string"===typeof e?e.trim():e)},expression:"addClockRecord.staffName"}}),n("q-input",{staticClass:"q-my-md",attrs:{filled:"",type:"text",label:"輸入您的員編",rules:[t.rules.required],"hide-bottom-space":""},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"pin"}})]},proxy:!0}]),model:{value:t.addClockRecord.staffNum,callback:function(e){t.$set(t.addClockRecord,"staffNum","string"===typeof e?e.trim():e)},expression:"addClockRecord.staffNum"}}),n("q-btn",{staticClass:"full-width q-mt-lg",attrs:{push:"",color:"blue-grey-9",type:"submit"}},[t._v("\n                點擊打卡\n              ")])],1)])],1)],1):n("q-card",{staticClass:"shadow-8",staticStyle:{width:"350px"},attrs:{square:""}},[n("q-card-section",{staticClass:"bg-blue-grey-9"},[n("h4",{staticClass:"text-white text-center q-my-sm"},[t._v("遠端打卡系統")])]),n("q-card-section",[n("div",{staticClass:"q-px-md q-py-lg row q-col-gutter-sm"},[n("div",{staticClass:"col-9 column"},[n("q-input",{attrs:{outlined:"",dense:"",label:"請輸入識別碼",maxlength:"8"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getClockSet(e)}},model:{value:t.clockPassword,callback:function(e){t.clockPassword=e},expression:"clockPassword"}})],1),n("div",{staticClass:"col-3"},[n("q-btn",{staticClass:"text-white full-width",attrs:{push:"",color:"blue-grey-9"},on:{click:t.getClockSet}},[t._v("\n                驗證\n              ")])],1)])])],1)],1)],1)],1)},r=[],c=n("9523"),a=n.n(c),i=n("c973"),s=n.n(i),u=n("ded3"),l=n.n(u),d=(n("96cf"),n("ac1f"),n("5319"),n("a9e3"),n("99af"),n("4de4"),n("d3b7"),n("e6cf"),n("2f62")),f=n("5f37"),p={name:"clockIn",data:function(){return{showAddClockRecord:!1,clockPassword:null,clockData:{},options:{clockInType:[{text:"上班卡",value:1},{text:"下班卡",value:2}]},addClockRecord:{},setClockTime:[],rules:f["a"],nowTime:null}},computed:l()(l()({},Object(d["d"])("authority/account",["userData","clockTime"])),{},{goWarkBegin:function(){var t=this.clockTime.goWarkBegin.replace(":","");return Number(t)},goWarkEnd:function(){var t=this.clockTime.goWarkEnd.replace(":","");return Number(t)},offWarkBegin:function(){var t=this.clockTime.offWarkBegin.replace(":","");return Number(t)},offWarkEnd:function(){var t=this.clockTime.offWarkEnd.replace(":","");return Number(t)}}),methods:l()(l()({},Object(d["b"])("authority/account",["fetchUser","fetchClockSetUp"])),{},{checkTimeConClockIn:function(){var t=new Date,e=t.getHours(),n=t.getMinutes(),o=Number("".concat(e).concat(n<10?"0"+n:n));return 1==this.addClockRecord.clockInType?o>=this.goWarkBegin&&o<this.goWarkEnd:o>=this.offWarkBegin&&o<this.offWarkEnd},checkPosition:function(){var t=this;this.getMap().then((function(){t.onSubmit()}))},onSubmit:function(){var t=this;return s()(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.addClockRecord.locationCoordinate||!t.clockTime.locationSwitch){e.next=3;break}return t.$swal({icon:"error",title:"位置資訊讀取錯誤"}),e.abrupt("return");case 3:if(t.checkTimeConClockIn()){e.next=6;break}return t.$swal({icon:"error",title:"打卡失敗",text:"目前不在設定的打卡區間內"}),e.abrupt("return");case 6:n={},a()(n,"".concat(t.clockData.clockInType),1==t.addClockRecord.clockInType?"上班卡":"下班卡"),a()(n,"".concat(t.clockData.staffName),t.addClockRecord.staffName),a()(n,"".concat(t.clockData.staffNum),t.addClockRecord.staffNum),a()(n,"".concat(t.clockData.locationCoordinate),t.addClockRecord.locationCoordinate),o=n,t.$q.loading.show(),r="https://docs.google.com/forms/u/0/d/e/".concat(t.clockData.createClockRecord,"/formResponse"),t.$q.loading.show(),$.ajax({type:"POST",url:r,data:o,contentType:"application/json",dataType:"jsonp"}).fail((function(e){200==e.status?(t.$q.loading.hide(),t.clockData={},t.clockPassword=null,t.$swal({title:"打卡成功",icon:"success",timer:1e3,showConfirmButton:!1})):(t.$q.loading.hide(),t.$swal({title:"打卡失敗",text:e,icon:"error"}))}));case 11:case"end":return e.stop()}}),e)})))()},getClockSet:function(){var t=this;return s()(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.chechPorM()){e.next=3;break}return t.$swal({icon:"warning",title:"請使用手機進行打卡"}),e.abrupt("return");case 3:if(t.clockPassword){e.next=6;break}return t.$swal({icon:"warning",title:"未輸入識別碼"}),e.abrupt("return");case 6:return t.$q.loading.show({message:"驗證中..."}),e.next=9,t.fetchUser();case 9:if(n=t.userData.filter((function(e){return e.clockPassword==t.clockPassword})),n.length&&n[0].conUse){e.next=14;break}return t.$q.loading.hide(),t.$swal({icon:"error",title:"驗證失敗",text:"公司未註冊或識別碼錯誤"}),e.abrupt("return");case 14:return e.next=16,t.fetchClockSetUp(n[0].clockSetUp);case 16:t.setClockTime=_.cloneDeep(t.clockTime),t.$q.loading.hide(),t.showAddClockRecord=!0,t.$swal({icon:"success",timer:1e3,showConfirmButton:!1,title:"驗證成功"}).then((function(){t.clockData=n[0]}));case 20:case"end":return e.stop()}}),e)})))()},showTime:function(){var t=new Date,e=t.getHours(),n=t.getMinutes(),o=t.getSeconds(),r="".concat(e>12?"下午":"上午");this.nowTime="".concat(r," ").concat(e," 時 ").concat(n," 分 ").concat(o," 秒")},getMap:function(){var t=this;return new Promise((function(e,n){t.clockTime.locationSwitch?navigator.geolocation.getCurrentPosition((function(n){var o=n.coords,r=o.latitude,c=o.longitude;t.addClockRecord.locationCoordinate="".concat(r,",").concat(c),e()})):e()}))},chechPorM:function(){var t=/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?"Mobile":"PC";return"Mobile"==t}}),mounted:function(){var t=this;setInterval((function(){t.showTime()}),1e3)}},m=p,k=n("2877"),h=n("4d5a"),g=n("09e3"),C=n("9989"),b=n("f09f"),w=n("a370"),y=n("27f9"),x=n("9c40"),v=n("0378"),q=n("ddd8"),T=n("0016"),R=n("eebe"),S=n.n(R),N=Object(k["a"])(m,o,r,!1,null,null,null);e["default"]=N.exports;S()(N,"components",{QLayout:h["a"],QPageContainer:g["a"],QPage:C["a"],QCard:b["a"],QCardSection:w["a"],QInput:y["a"],QBtn:x["a"],QForm:v["a"],QSelect:q["a"],QIcon:T["a"]})}}]);